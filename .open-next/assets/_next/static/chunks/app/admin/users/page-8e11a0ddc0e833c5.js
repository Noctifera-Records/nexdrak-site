(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[733],{46:(e,s,r)=>{Promise.resolve().then(r.bind(r,7077))},7077:(e,s,r)=>{"use strict";r.d(s,{default:()=>f});var a=r(5155),t=r(2115),l=r(7003),i=r(6170),c=r(235),n=r(6485),d=r(1010),x=r(3664),o=r(6651),m=r(7910),h=r(1360),u=r(508),g=r(2181),j=r(501),y=r(4679),N=r(3550),p=r(8525),b=r(63);function f(e){let{users:s}=e,[r,c]=(0,t.useState)(s),[N,f]=(0,t.useState)(""),[w,C]=(0,t.useState)(null),[A,E]=(0,t.useState)(!1),[k,S]=(0,t.useState)(null),L=(0,p.createClient)(),_=(0,b.useRouter)(),U=r.filter(e=>{var s;return e.email.toLowerCase().includes(N.toLowerCase())||(null==(s=e.username)?void 0:s.toLowerCase().includes(N.toLowerCase()))||e.role.toLowerCase().includes(N.toLowerCase())}),q=async(e,s)=>{E(!0);try{let{error:a}=await L.from("profiles").update(s).eq("id",e);if(a)throw a;c(r.map(r=>r.id===e?{...r,...s}:r)),C(null),_.refresh()}catch(e){alert("Error al actualizar usuario")}finally{E(!1)}},z=async e=>{E(!0);try{let{error:s}=await L.from("profiles").delete().eq("id",e);if(s)throw s;let{error:a}=await L.auth.admin.deleteUser(e);c(r.filter(s=>s.id!==e)),S(null),_.refresh()}catch(e){alert("Error al eliminar usuario")}finally{E(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(o.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)(i.p,{placeholder:"Buscar por email, username o rol...",value:N,onChange:e=>f(e.target.value),className:"pl-10 bg-gray-900 border-gray-700 text-white"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:[U.length," de ",r.length," usuarios"]})]}),(0,a.jsxs)("div",{className:"bg-gray-900 rounded-lg border border-gray-700 overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-800 border-b border-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Usuario"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Rol"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Estado"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Registro"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-700",children:U.map(e=>{var s;return(0,a.jsxs)("tr",{className:"hover:bg-gray-800/50",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-gray-700 rounded-full p-2",children:(0,a.jsx)(u.A,{className:"h-4 w-4 text-gray-300"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-white",children:e.username||"Sin username"}),(0,a.jsxs)("div",{className:"text-sm text-gray-400 flex items-center",children:[(0,a.jsx)(x.A,{className:"h-3 w-3 mr-1"}),e.email]})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e){case"admin":return(0,a.jsx)(m.A,{className:"h-4 w-4 text-red-400"});case"user":return(0,a.jsx)(u.A,{className:"h-4 w-4 text-blue-400"});default:return(0,a.jsx)(u.A,{className:"h-4 w-4 text-gray-400"})}})(e.role),(0,a.jsx)("span",{className:(e=>{let s="px-2 py-1 rounded-full text-xs font-medium";switch(e){case"admin":return"".concat(s," bg-red-900/30 text-red-300 border border-red-500/30");case"user":return"".concat(s," bg-blue-900/30 text-blue-300 border border-blue-500/30");default:return"".concat(s," bg-gray-900/30 text-gray-300 border border-gray-500/30")}})(e.role),children:e.role.toUpperCase()})]})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"flex items-center space-x-2",children:e.email_confirmed_at?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-green-400"}),(0,a.jsx)("span",{className:"text-sm text-green-400",children:"Verificado"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"h-4 w-4 text-yellow-400"}),(0,a.jsx)("span",{className:"text-sm text-yellow-400",children:"Pendiente"})]})})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-400",children:[(0,a.jsx)(n.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:(s=e.created_at)?new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"N/A"})]})}),(0,a.jsx)("td",{className:"px-6 py-4 text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,a.jsxs)(y.lG,{children:[(0,a.jsx)(y.zM,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",size:"sm",onClick:()=>C(e),children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(y.Cf,{className:"bg-gray-900 border-gray-700",children:[(0,a.jsxs)(y.c7,{children:[(0,a.jsx)(y.L3,{className:"text-white",children:"Editar Usuario"}),(0,a.jsx)(y.rr,{className:"text-gray-400",children:"Modifica la informaci\xf3n del usuario"})]}),w&&(0,a.jsx)(v,{user:w,onSave:q,loading:A})]})]}),(0,a.jsxs)(y.lG,{children:[(0,a.jsx)(y.zM,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:(0,a.jsx)(h.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(y.Cf,{className:"bg-gray-900 border-gray-700",children:[(0,a.jsxs)(y.c7,{children:[(0,a.jsx)(y.L3,{className:"text-white",children:"Eliminar Usuario"}),(0,a.jsxs)(y.rr,{className:"text-gray-400",children:["\xbfEst\xe1s seguro de que quieres eliminar a ",e.username||e.email,"? Esta acci\xf3n no se puede deshacer."]})]}),(0,a.jsxs)(y.Es,{children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>S(null),className:"border-gray-600 text-gray-300",children:"Cancelar"}),(0,a.jsx)(l.$,{variant:"destructive",onClick:()=>z(e.id),disabled:A,children:A?"Eliminando...":"Eliminar"})]})]})]})]})})]},e.id)})})]})}),0===U.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(u.A,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-400",children:N?"No se encontraron usuarios":"No hay usuarios registrados"})]})]})]})}function v(e){let{user:s,onSave:r,loading:n}=e,[d,x]=(0,t.useState)(s.username||""),[o,m]=(0,t.useState)(s.role);return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(s.id,{username:d,role:o})},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{htmlFor:"username",className:"text-white",children:"Nombre de Usuario"}),(0,a.jsx)(i.p,{id:"username",value:d,onChange:e=>x(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"Ingresa el username"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c.J,{htmlFor:"role",className:"text-white",children:"Rol"}),(0,a.jsxs)(N.l6,{value:o,onValueChange:m,children:[(0,a.jsx)(N.bq,{className:"bg-gray-800 border-gray-600 text-white",children:(0,a.jsx)(N.yv,{})}),(0,a.jsxs)(N.gC,{className:"bg-gray-800 border-gray-600",children:[(0,a.jsx)(N.eb,{value:"user",children:"Usuario"}),(0,a.jsx)(N.eb,{value:"admin",children:"Administrador"})]})]})]}),(0,a.jsx)(y.Es,{children:(0,a.jsx)(l.$,{type:"submit",disabled:n,className:"bg-white text-black hover:bg-gray-200",children:n?"Guardando...":"Guardar Cambios"})})]})}}},e=>{e.O(0,[96,76,358],()=>e(e.s=46)),_N_E=e.O()}]);