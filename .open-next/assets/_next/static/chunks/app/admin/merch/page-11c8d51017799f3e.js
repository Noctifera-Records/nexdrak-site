(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[782],{1025:(e,a,s)=>{Promise.resolve().then(s.bind(s,9771))},9771:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>k});var r=s(5155),l=s(2115),i=s(8843),t=s(7003),c=s(8525),n=s(5239),d=s(1010),o=s(5880),h=s(7828),m=s(532),x=s(1360),u=s(3209),p=s(7812);function j(e){let{items:a,onEdit:s,onDelete:i}=e,[j,g]=(0,l.useState)(null),N=(0,c.createClient)(),v=async e=>{g(e.id);try{let{error:a}=await N.from("merch").update({is_available:!e.is_available}).eq("id",e.id);if(a)return void alert("Error al actualizar la disponibilidad");e.is_available=!e.is_available}catch(e){alert("Error al actualizar la disponibilidad")}finally{g(null)}},f=e=>new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"});return 0===a.length?(0,r.jsx)(u.Zp,{children:(0,r.jsx)(u.Wu,{className:"p-8 text-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No hay productos de merchandise registrados."})})}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"hidden lg:block",children:(0,r.jsxs)(u.Zp,{children:[(0,r.jsx)(u.aR,{children:(0,r.jsxs)(u.ZB,{children:["Productos (",a.length,")"]})}),(0,r.jsx)(u.Wu,{children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("th",{className:"text-left p-2",children:"Imagen"}),(0,r.jsx)("th",{className:"text-left p-2",children:"Producto"}),(0,r.jsx)("th",{className:"text-left p-2",children:"Precio"}),(0,r.jsx)("th",{className:"text-left p-2",children:"Categor\xeda"}),(0,r.jsx)("th",{className:"text-left p-2",children:"Estado"}),(0,r.jsx)("th",{className:"text-left p-2",children:"Fecha"}),(0,r.jsx)("th",{className:"text-left p-2",children:"Acciones"})]})}),(0,r.jsx)("tbody",{children:a.map(e=>(0,r.jsxs)("tr",{className:"border-b hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,r.jsx)("td",{className:"p-2",children:(0,r.jsx)("div",{className:"w-12 h-12 relative bg-gray-200 rounded",children:e.image_url?(0,r.jsx)(n.default,{src:e.image_url,alt:e.name,fill:!0,className:"object-cover rounded"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs",children:"No img"})})}),(0,r.jsx)("td",{className:"p-2",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:e.name}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-500 line-clamp-1",children:e.description})]})}),(0,r.jsx)("td",{className:"p-2",children:(0,r.jsxs)("span",{className:"font-semibold",children:["$",e.price]})}),(0,r.jsx)("td",{className:"p-2",children:(0,r.jsx)(p.E,{variant:"secondary",children:e.category})}),(0,r.jsx)("td",{className:"p-2",children:(0,r.jsx)(t.$,{variant:"ghost",size:"sm",onClick:()=>v(e),disabled:j===e.id,className:e.is_available?"text-green-600":"text-red-600",children:j===e.id?(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.is_available?(0,r.jsx)(h.A,{className:"h-4 w-4"}):(0,r.jsx)(m.A,{className:"h-4 w-4"})})}),(0,r.jsx)("td",{className:"p-2 text-sm text-gray-500",children:f(e.created_at)}),(0,r.jsx)("td",{className:"p-2",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(t.$,{variant:"ghost",size:"sm",asChild:!0,children:(0,r.jsx)("a",{href:e.purchase_url,target:"_blank",rel:"noopener noreferrer",title:"Ver enlace de compra",children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsx)(t.$,{variant:"ghost",size:"sm",onClick:()=>s(e),children:(0,r.jsx)(d.A,{className:"h-4 w-4"})}),(0,r.jsx)(t.$,{variant:"ghost",size:"sm",onClick:()=>i(e.id),className:"text-red-600 hover:text-red-700",children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})]})})]},e.id))})]})})})]})}),(0,r.jsx)("div",{className:"lg:hidden space-y-4",children:a.map(e=>(0,r.jsx)(u.Zp,{children:(0,r.jsx)(u.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 relative bg-gray-200 rounded flex-shrink-0",children:e.image_url?(0,r.jsx)(n.default,{src:e.image_url,alt:e.name,fill:!0,className:"object-cover rounded"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs",children:"No img"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsx)("h3",{className:"font-medium truncate",children:e.name}),(0,r.jsx)(t.$,{variant:"ghost",size:"sm",onClick:()=>v(e),disabled:j===e.id,className:e.is_available?"text-green-600":"text-red-600",children:j===e.id?(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.is_available?(0,r.jsx)(h.A,{className:"h-4 w-4"}):(0,r.jsx)(m.A,{className:"h-4 w-4"})})]}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsxs)("span",{className:"font-semibold",children:["$",e.price]}),(0,r.jsx)(p.E,{variant:"secondary",className:"text-xs",children:e.category})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mb-3",children:["Creado: ",f(e.created_at)]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(t.$,{variant:"outline",size:"sm",asChild:!0,className:"flex-1",children:(0,r.jsxs)("a",{href:e.purchase_url,target:"_blank",rel:"noopener noreferrer",children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Ver"]})}),(0,r.jsx)(t.$,{variant:"outline",size:"sm",onClick:()=>s(e),children:(0,r.jsx)(d.A,{className:"h-4 w-4"})}),(0,r.jsx)(t.$,{variant:"outline",size:"sm",onClick:()=>i(e.id),className:"text-red-600 hover:text-red-700",children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})]})]})]})})},e.id))})]})}var g=s(6363),N=s(6170),v=s(235),f=s(7001),b=s(3550),y=s(7235),_=s(6014);let w=["clothing","accessories","vinyl","digital","collectibles","other"];function C(e){let{item:a,onClose:s}=e,[i,n]=(0,l.useState)({name:"",description:"",price:"",image_url:"",purchase_url:"",category:"other",is_available:!0}),[d,o]=(0,l.useState)(!1),h=(0,c.createClient)();(0,l.useEffect)(()=>{a&&n({name:a.name,description:a.description||"",price:a.price.toString(),image_url:a.image_url||"",purchase_url:a.purchase_url,category:a.category,is_available:a.is_available})},[a]);let m=async e=>{e.preventDefault(),o(!0);try{let e=parseFloat(i.price);if(isNaN(e)||e<0){alert("Por favor ingresa un precio v\xe1lido"),o(!1);return}let r={name:i.name.trim(),description:i.description.trim()||null,price:e,image_url:i.image_url.trim()||null,purchase_url:i.purchase_url.trim(),category:i.category,is_available:i.is_available};if(a?(await h.from("merch").update(r).eq("id",a.id)).error:(await h.from("merch").insert([r])).error)return void alert("Error al guardar el producto");s()}catch(e){alert("Error al guardar el producto")}finally{o(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)(u.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)(u.aR,{className:"flex flex-row items-center justify-between",children:[(0,r.jsx)(u.ZB,{children:a?"Editar Producto":"Agregar Producto"}),(0,r.jsx)(t.$,{variant:"ghost",size:"sm",onClick:s,children:(0,r.jsx)(g.X,{className:"h-4 w-4"})})]}),(0,r.jsx)(u.Wu,{children:(0,r.jsxs)("form",{onSubmit:m,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.J,{htmlFor:"name",children:"Nombre del Producto *"}),(0,r.jsx)(N.p,{id:"name",value:i.name,onChange:e=>n(a=>({...a,name:e.target.value})),placeholder:"Ej: Camiseta Logo NexDrak",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.J,{htmlFor:"description",children:"Descripci\xf3n"}),(0,r.jsx)(f.T,{id:"description",value:i.description,onChange:e=>n(a=>({...a,description:e.target.value})),placeholder:"Descripci\xf3n del producto...",rows:3})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.J,{htmlFor:"price",children:"Precio (USD) *"}),(0,r.jsx)(N.p,{id:"price",type:"number",step:"0.01",min:"0",value:i.price,onChange:e=>n(a=>({...a,price:e.target.value})),placeholder:"29.99",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.J,{htmlFor:"category",children:"Categor\xeda *"}),(0,r.jsxs)(b.l6,{value:i.category,onValueChange:e=>n(a=>({...a,category:e})),children:[(0,r.jsx)(b.bq,{children:(0,r.jsx)(b.yv,{placeholder:"Selecciona una categor\xeda"})}),(0,r.jsx)(b.gC,{children:w.map(e=>(0,r.jsx)(b.eb,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.J,{htmlFor:"purchase_url",children:"URL de Compra *"}),(0,r.jsx)(N.p,{id:"purchase_url",type:"url",value:i.purchase_url,onChange:e=>n(a=>({...a,purchase_url:e.target.value})),placeholder:"https://shop.example.com/product",required:!0}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Enlace donde los usuarios pueden comprar este producto (ej: Shopify, Etsy, etc.)"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.J,{children:"Imagen del Producto"}),(0,r.jsx)(_.o,{onImageUpload:e=>{n(a=>({...a,image_url:e}))},currentImage:i.image_url})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(y.d,{id:"is_available",checked:i.is_available,onCheckedChange:e=>n(a=>({...a,is_available:e}))}),(0,r.jsx)(v.J,{htmlFor:"is_available",children:"Producto disponible"})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,r.jsx)(t.$,{type:"button",variant:"outline",onClick:s,children:"Cancelar"}),(0,r.jsx)(t.$,{type:"submit",disabled:d,children:d?"Guardando...":a?"Actualizar":"Crear"})]})]})})]})})}function k(){let[e,a]=(0,l.useState)([]),[s,n]=(0,l.useState)(!0),[d,o]=(0,l.useState)(!1),[h,m]=(0,l.useState)(null),x=(0,c.createClient)();(0,l.useEffect)(()=>{u()},[]);let u=async()=>{try{let{data:e,error:s}=await x.from("merch").select("*").order("created_at",{ascending:!1});if(s)return;a(e||[])}catch(e){}finally{n(!1)}},p=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este producto?"))try{let{error:s}=await x.from("merch").delete().eq("id",e);if(s)return void alert("Error al eliminar el producto");a(a=>a.filter(a=>a.id!==e))}catch(e){alert("Error al eliminar el producto")}};return s?(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Merchandise"})}),(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{children:"Cargando productos..."})})]}):(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Merchandise"}),(0,r.jsxs)(t.$,{onClick:()=>o(!0),children:[(0,r.jsx)(i.F,{className:"h-4 w-4 mr-2"}),"Agregar Producto"]})]}),(0,r.jsx)(j,{items:e,onEdit:e=>{m(e),o(!0)},onDelete:p}),d&&(0,r.jsx)(C,{item:h,onClose:()=>{o(!1),m(null),u()}})]})}}},e=>{e.O(0,[96,76,358],()=>e(e.s=1025)),_N_E=e.O()}]);