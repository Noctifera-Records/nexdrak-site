(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[624],{4830:(e,a,s)=>{"use strict";s.d(a,{default:()=>_});var r=s(5155),l=s(2115),t=s(7003),i=s(6170),c=s(235),d=s(7001),n=s(9867),o=s(1010),x=s(2196),h=s(3586),m=s(6617),g=s(6191),u=s(6651),j=s(9347),p=s(1360),v=s(4679),y=s(3550),f=s(7235),b=s(7812),N=s(8525),w=s(63),C=s(6014),E=s(5239);function _(e){let{downloads:a}=e,[s,c]=(0,l.useState)(a),[d,C]=(0,l.useState)(""),[_,A]=(0,l.useState)("all"),[z,k]=(0,l.useState)(null),[D,L]=(0,l.useState)(!1),[F,J]=(0,l.useState)(!1),q=(0,N.createClient)(),M=(0,w.useRouter)(),O=s.filter(e=>{var a;let s=e.title.toLowerCase().includes(d.toLowerCase())||(null==(a=e.description)?void 0:a.toLowerCase().includes(d.toLowerCase())),r="all"===_||e.category===_;return s&&r}),$=async e=>{L(!0);try{let{data:a,error:r}=await q.from("downloads").insert([{...e,download_count:0}]).select().single();if(r)throw Error("Error de base de datos: ".concat(r.message));c([a,...s]),J(!1),M.refresh()}catch(a){let e=a instanceof Error?a.message:"Error desconocido";alert("Error al agregar descarga: ".concat(e))}finally{L(!1)}},G=async(e,a)=>{L(!0);try{let{error:r}=await q.from("downloads").update(a).eq("id",e);if(r)throw Error("Error de base de datos: ".concat(r.message));c(s.map(s=>s.id===e?{...s,...a}:s)),k(null),M.refresh()}catch(a){let e=a instanceof Error?a.message:"Error desconocido";alert("Error al actualizar descarga: ".concat(e))}finally{L(!1)}},P=async e=>{L(!0);try{let{error:a}=await q.from("downloads").delete().eq("id",e);if(a)throw Error("Error de base de datos: ".concat(a.message));c(s.filter(a=>a.id!==e)),M.refresh()}catch(a){let e=a instanceof Error?a.message:"Error desconocido";alert("Error al eliminar descarga: ".concat(e))}finally{L(!1)}},T=async(e,a)=>{await G(e,{is_featured:a})},U=e=>{switch(e){case"wallpaper":return(0,r.jsx)(x.A,{className:"h-4 w-4"});case"mp3":return(0,r.jsx)(h.A,{className:"h-4 w-4"});default:return(0,r.jsx)(m.A,{className:"h-4 w-4"})}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(i.p,{placeholder:"Buscar descargas...",value:d,onChange:e=>C(e.target.value),className:"pl-10 bg-gray-900 border-gray-700 text-white"})]}),(0,r.jsxs)(y.l6,{value:_,onValueChange:A,children:[(0,r.jsx)(y.bq,{className:"w-full md:w-48 bg-gray-900 border-gray-700 text-white",children:(0,r.jsx)(y.yv,{})}),(0,r.jsxs)(y.gC,{className:"bg-gray-900 border-gray-700",children:[(0,r.jsx)(y.eb,{value:"all",children:"Todas las categor\xedas"}),(0,r.jsx)(y.eb,{value:"wallpaper",children:"Wallpapers"}),(0,r.jsx)(y.eb,{value:"mp3",children:"Audio"}),(0,r.jsx)(y.eb,{value:"other",children:"Otros"})]})]})]}),(0,r.jsxs)(v.lG,{open:F,onOpenChange:J,children:[(0,r.jsx)(v.zM,{asChild:!0,children:(0,r.jsxs)(t.$,{className:"bg-white text-black hover:bg-gray-200",children:[(0,r.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Agregar Descarga"]})}),(0,r.jsxs)(v.Cf,{className:"bg-gray-900 border-gray-700 max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)(v.c7,{children:[(0,r.jsx)(v.L3,{className:"text-white",children:"Nueva Descarga"}),(0,r.jsx)(v.rr,{className:"text-gray-400",children:"Agrega nuevo contenido para descargar"})]}),(0,r.jsx)(S,{onSave:$,loading:D})]})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.map(e=>(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg border border-gray-700 overflow-hidden group hover:border-gray-600 transition-all",children:[(0,r.jsxs)("div",{className:"relative aspect-video bg-gray-800",children:[e.thumbnail_url?(0,r.jsx)(E.default,{src:e.thumbnail_url,alt:e.title,fill:!0,className:"object-cover group-hover:scale-105 transition-transform"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:U(e.category)}),(0,r.jsxs)("div",{className:"absolute top-2 left-2 flex space-x-2",children:[e.is_featured&&(0,r.jsxs)(b.E,{className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",children:[(0,r.jsx)(j.A,{className:"h-3 w-3 mr-1"}),"Destacado"]}),(0,r.jsxs)(b.E,{className:"".concat((e=>{switch(e){case"wallpaper":return"bg-blue-900/30 text-blue-300 border-blue-500/30";case"mp3":return"bg-purple-900/30 text-purple-300 border-purple-500/30";default:return"bg-gray-900/30 text-gray-300 border-gray-500/30"}})(e.category)," border"),children:[U(e.category),(0,r.jsx)("span",{className:"ml-1 capitalize",children:e.category})]})]})]}),(0,r.jsxs)("div",{className:"p-4 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white truncate",children:e.title}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-400 line-clamp-2 mt-1",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[e.file_size&&(0,r.jsx)("span",{children:e.file_size}),e.file_format&&(0,r.jsx)("span",{className:"bg-gray-800 px-2 py-1 rounded",children:e.file_format})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(n.A,{className:"h-3 w-3"}),(0,r.jsx)("span",{children:e.download_count})]})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f.d,{checked:e.is_featured,onCheckedChange:a=>T(e.id,a),size:"sm"}),(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"Destacado"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(v.lG,{children:[(0,r.jsx)(v.zM,{asChild:!0,children:(0,r.jsx)(t.$,{variant:"ghost",size:"sm",onClick:()=>k(e),children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(v.Cf,{className:"bg-gray-900 border-gray-700 max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)(v.c7,{children:[(0,r.jsx)(v.L3,{className:"text-white",children:"Editar Descarga"}),(0,r.jsx)(v.rr,{className:"text-gray-400",children:"Modifica la informaci\xf3n de la descarga"})]}),z&&(0,r.jsx)(S,{download:z,onSave:e=>G(z.id,e),loading:D})]})]}),(0,r.jsxs)(v.lG,{children:[(0,r.jsx)(v.zM,{asChild:!0,children:(0,r.jsx)(t.$,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(v.Cf,{className:"bg-gray-900 border-gray-700",children:[(0,r.jsxs)(v.c7,{children:[(0,r.jsx)(v.L3,{className:"text-white",children:"Eliminar Descarga"}),(0,r.jsxs)(v.rr,{className:"text-gray-400",children:['\xbfEst\xe1s seguro de que quieres eliminar "',e.title,'"? Esta acci\xf3n no se puede deshacer.']})]}),(0,r.jsxs)(v.Es,{children:[(0,r.jsx)(t.$,{variant:"outline",className:"border-gray-600 text-gray-300",children:"Cancelar"}),(0,r.jsx)(t.$,{variant:"destructive",onClick:()=>P(e.id),disabled:D,children:D?"Eliminando...":"Eliminar"})]})]})]})]})]})]})]},e.id))}),0===O.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(n.A,{className:"h-16 w-16 text-gray-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-400 text-lg mb-2",children:d||"all"!==_?"No se encontraron descargas":"No hay descargas"}),(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:!d&&"all"===_&&"Agrega tu primera descarga para comenzar"})]})]})}function S(e){let{download:a,onSave:s,loading:n}=e,[o,x]=(0,l.useState)((null==a?void 0:a.title)||""),[h,m]=(0,l.useState)((null==a?void 0:a.description)||""),[g,u]=(0,l.useState)((null==a?void 0:a.category)||"wallpaper"),[j,p]=(0,l.useState)((null==a?void 0:a.file_url)||""),[b,N]=(0,l.useState)((null==a?void 0:a.thumbnail_url)||""),[w,E]=(0,l.useState)((null==a?void 0:a.file_size)||""),[_,S]=(0,l.useState)((null==a?void 0:a.file_format)||""),[A,z]=(0,l.useState)((null==a?void 0:a.is_featured)||!1);return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s({title:o,description:h||null,category:g,file_url:j,thumbnail_url:b||null,file_size:w||null,file_format:_||null,is_featured:A})},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{htmlFor:"title",className:"text-white",children:"T\xedtulo *"}),(0,r.jsx)(i.p,{id:"title",value:o,onChange:e=>x(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"Nombre de la descarga",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{htmlFor:"category",className:"text-white",children:"Categor\xeda *"}),(0,r.jsxs)(y.l6,{value:g,onValueChange:u,children:[(0,r.jsx)(y.bq,{className:"bg-gray-800 border-gray-600 text-white",children:(0,r.jsx)(y.yv,{})}),(0,r.jsxs)(y.gC,{className:"bg-gray-800 border-gray-600",children:[(0,r.jsx)(y.eb,{value:"wallpaper",children:"Wallpaper"}),(0,r.jsx)(y.eb,{value:"mp3",children:"Audio"}),(0,r.jsx)(y.eb,{value:"other",children:"Otro"})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{htmlFor:"description",className:"text-white",children:"Descripci\xf3n"}),(0,r.jsx)(d.T,{id:"description",value:h,onChange:e=>m(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"Descripci\xf3n de la descarga",rows:3})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{htmlFor:"fileUrl",className:"text-white",children:"URL del Archivo *"}),(0,r.jsx)(i.p,{id:"fileUrl",value:j,onChange:e=>p(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"https://ejemplo.com/archivo.zip",required:!0}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Enlace directo al archivo alojado en otra plataforma"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{className:"text-white",children:"Imagen de Vista Previa"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(C.A,{value:b,onChange:N,label:"",maxSize:2}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"O ingresa una URL directamente:"}),(0,r.jsx)(i.p,{value:b,onChange:e=>N(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"https://ejemplo.com/preview.jpg"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{htmlFor:"fileSize",className:"text-white",children:"Tama\xf1o del Archivo"}),(0,r.jsx)(i.p,{id:"fileSize",value:w,onChange:e=>E(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"2.5 MB"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{htmlFor:"fileFormat",className:"text-white",children:"Formato"}),(0,r.jsx)(i.p,{id:"fileFormat",value:_,onChange:e=>S(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"ZIP, MP3, JPG, etc."})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f.d,{checked:A,onCheckedChange:z}),(0,r.jsx)(c.J,{className:"text-white",children:"Destacado"})]}),(0,r.jsx)(v.Es,{children:(0,r.jsx)(t.$,{type:"submit",disabled:n||!o||!j,className:"bg-white text-black hover:bg-gray-200",children:n?"Guardando...":a?"Actualizar":"Crear"})})]})}},7335:(e,a,s)=>{Promise.resolve().then(s.bind(s,4830))}},e=>{e.O(0,[96,76,358],()=>e(e.s=7335)),_N_E=e.O()}]);