(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{1726:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>m});var r=a(5155),t=a(2115),i=a(7003),l=a(6170),n=a(235),d=a(3209),o=a(8525),c=a(1195);function m(){let[e,s]=(0,t.useState)(null),[a,m]=(0,t.useState)(null),[h,x]=(0,t.useState)({email:"",username:"",newPassword:"",confirmPassword:""}),[u,p]=(0,t.useState)(!1),[w,g]=(0,t.useState)(!0),y=(0,o.createClient)(),{showNotification:f}=(0,c.E)();(0,t.useEffect)(()=>{(async()=>{let{data:{user:e}}=await y.auth.getUser();if(!e){window.location.href="/login";return}s(e);let{data:a}=await y.from("profiles").select("*").eq("id",e.id).single();a&&(m(a),x(s=>({...s,email:e.email||"",username:a.username||""}))),g(!1)})()},[y]);let j=e=>{x(s=>({...s,[e.target.name]:e.target.value}))},N=async()=>{p(!0);try{let{error:s}=await y.from("profiles").update({username:h.username,email:h.email}).eq("id",e.id);if(s)return void f({type:"error",title:"Error updating profile",message:s.message});if(h.email!==e.email){let{error:e}=await y.auth.updateUser({email:h.email});if(e)return void f({type:"error",title:"Error updating email",message:e.message})}f({type:"success",title:"Updated profile",message:"Your information has been successfully updated"})}catch(e){f({type:"error",title:"Unexpected error",message:"An error occurred while updating the profile"})}finally{p(!1)}},b=async()=>{if(!h.newPassword||!h.confirmPassword)return void f({type:"error",title:"Validation error",message:"Complete all password fields"});if(h.newPassword!==h.confirmPassword)return void f({type:"error",title:"Validation error",message:"Passwords do not match"});if(h.newPassword.length<6)return void f({type:"error",title:"Validation error",message:"The password must be at least 6 characters long"});p(!0);try{let{error:e}=await y.auth.updateUser({password:h.newPassword});if(e)return void f({type:"error",title:"Error changing password",message:e.message});f({type:"success",title:"Password updated",message:"Your password has been successfully changed"}),x(e=>({...e,newPassword:"",confirmPassword:""}))}catch(e){f({type:"error",title:"Unexpected error",message:"Unexpected error"})}finally{p(!1)}};return w?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("p",{className:"text-white",children:"Loading information..."})})}):(0,r.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"My Account - Admin"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Manage your administrator information"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(d.Zp,{className:"bg-gray-900 border-gray-700",children:[(0,r.jsx)(d.aR,{children:(0,r.jsx)(d.ZB,{className:"text-white",children:"Personal Information"})}),(0,r.jsxs)(d.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.J,{htmlFor:"email",className:"text-white",children:"Email"}),(0,r.jsx)(l.p,{id:"email",name:"email",type:"email",value:h.email,onChange:j,className:"bg-gray-800 border-gray-600 text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.J,{htmlFor:"username",className:"text-white",children:"User Name"}),(0,r.jsx)(l.p,{id:"username",name:"username",type:"text",value:h.username,onChange:j,className:"bg-gray-800 border-gray-600 text-white"})]}),(0,r.jsx)(i.$,{onClick:N,disabled:u,className:"bg-blue-600 hover:bg-blue-700 text-white",children:u?"Actualizando...":"Actualizar Perfil"})]})]}),(0,r.jsxs)(d.Zp,{className:"bg-gray-900 border-gray-700",children:[(0,r.jsx)(d.aR,{children:(0,r.jsx)(d.ZB,{className:"text-white",children:"Change Password"})}),(0,r.jsxs)(d.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.J,{htmlFor:"newPassword",className:"text-white",children:"New Password"}),(0,r.jsx)(l.p,{id:"newPassword",name:"newPassword",type:"password",value:h.newPassword,onChange:j,placeholder:"••••••••",className:"bg-gray-800 border-gray-600 text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.J,{htmlFor:"confirmPassword",className:"text-white",children:"Confirm New Password"}),(0,r.jsx)(l.p,{id:"confirmPassword",name:"confirmPassword",type:"password",value:h.confirmPassword,onChange:j,placeholder:"••••••••",className:"bg-gray-800 border-gray-600 text-white"})]}),(0,r.jsx)(i.$,{onClick:b,disabled:u,className:"bg-red-600 hover:bg-red-700 text-white",children:u?"Changing...":"Change Password"})]})]}),(0,r.jsxs)(d.Zp,{className:"bg-gray-900 border-gray-700",children:[(0,r.jsx)(d.aR,{children:(0,r.jsx)(d.ZB,{className:"text-white",children:"Account Information"})}),(0,r.jsx)(d.Wu,{children:(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("p",{className:"text-gray-300",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Type of account:"})," ","Administrator"]}),(0,r.jsxs)("p",{className:"text-gray-300",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Member since:"})," ",new Date(null==e?void 0:e.created_at).toLocaleDateString("es-ES")]}),(0,r.jsxs)("p",{className:"text-gray-300",children:[(0,r.jsx)("span",{className:"font-semibold",children:"User ID:"})," ",null==e?void 0:e.id]}),(0,r.jsxs)("p",{className:"text-gray-300",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Permits:"})," Full access to the administration panel"]})]})})]})]})]})}},1993:(e,s,a)=>{Promise.resolve().then(a.bind(a,1726))}},e=>{e.O(0,[96,76,358],()=>e(e.s=1993)),_N_E=e.O()}]);