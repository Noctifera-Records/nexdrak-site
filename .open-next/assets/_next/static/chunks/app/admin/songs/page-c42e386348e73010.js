(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743],{2933:(e,a,r)=>{Promise.resolve().then(r.bind(r,3288))},3288:(e,a,r)=>{"use strict";r.d(a,{default:()=>f});var s=r(5155),t=r(2115),l=r(7003),i=r(6170),n=r(235),c=r(3550),d=r(1010),o=r(5880),h=r(3586),m=r(6191),x=r(6651),g=r(1360),u=r(508),j=r(4679),v=r(8525),y=r(63),b=r(6014),N=r(5239);let p=e=>{if("string"==typeof e&&"album"===e.trim().toLowerCase())return"album";return"single"};function f(e){let{songs:a}=e,[r,n]=(0,t.useState)(a),[c,b]=(0,t.useState)(""),[f,C]=(0,t.useState)(null),[S,_]=(0,t.useState)(!1),[E,k]=(0,t.useState)(!1),A=(0,v.createClient)(),L=(0,y.useRouter)(),z=r.filter(e=>{var a;return e.title.toLowerCase().includes(c.toLowerCase())||(null==(a=e.artist)?void 0:a.toLowerCase().includes(c.toLowerCase()))}),q=async e=>{_(!0);try{let a=p(e.type),s={...e,type:a},{data:t,error:l}=await A.from("songs").insert([s]).select().single();if(l)throw Error("Error de base de datos: ".concat(l.message));n([t,...r]),k(!1),L.refresh()}catch(e){alert(e instanceof Error?e.message:"Error desconocido al agregar canci\xf3n")}finally{_(!1)}},F=async(e,a)=>{_(!0);try{let s=r.find(a=>a.id===e);if(!s)throw Error("Canci\xf3n no encontrada");let t=a.type||s.type,l=p(t),i={...a,type:l},{error:c}=await A.from("songs").update(i).eq("id",e);if(c)throw c;n(r.map(a=>a.id===e?{...a,...i}:a)),C(null),L.refresh()}catch(e){alert(e instanceof Error?e.message:"Error al actualizar canci\xf3n")}finally{_(!1)}},J=async e=>{_(!0);try{let{error:a}=await A.from("songs").delete().eq("id",e);if(a)throw a;n(r.filter(a=>a.id!==e)),L.refresh()}catch(e){alert("Error al eliminar canci\xf3n")}finally{_(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,s.jsx)(x.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)(i.p,{placeholder:"Buscar canciones...",value:c,onChange:e=>b(e.target.value),className:"pl-10 bg-gray-900 border-gray-700 text-white"})]}),(0,s.jsxs)(j.lG,{open:E,onOpenChange:k,children:[(0,s.jsx)(j.zM,{asChild:!0,children:(0,s.jsxs)(l.$,{className:"bg-white text-black hover:bg-gray-200",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Agregar Canci\xf3n"]})}),(0,s.jsxs)(j.Cf,{className:"bg-gray-900 border-gray-700 max-w-2xl",children:[(0,s.jsxs)(j.c7,{children:[(0,s.jsx)(j.L3,{className:"text-white",children:"Nueva Canci\xf3n"}),(0,s.jsx)(j.rr,{className:"text-gray-400",children:"Agrega una nueva canci\xf3n a tu cat\xe1logo"})]}),(0,s.jsx)(w,{onSave:q,loading:S})]})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:z.map(e=>(0,s.jsxs)("div",{className:"bg-gray-900 rounded-lg border border-gray-700 overflow-hidden group hover:border-gray-600 transition-all",children:[(0,s.jsxs)("div",{className:"aspect-square bg-gray-800 relative",children:[e.cover_image_url?(0,s.jsx)(N.default,{src:e.cover_image_url,alt:e.title,fill:!0,className:"object-cover group-hover:scale-105 transition-transform"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)(h.A,{className:"h-16 w-16 text-gray-600"})}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,s.jsx)(l.$,{variant:"outline",size:"sm",className:"border-white text-white hover:bg-white/20",asChild:!0,children:(0,s.jsxs)("a",{href:e.stream_url,target:"_blank",rel:"noopener noreferrer",children:[(0,s.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"ESCUCHAR"]})})})]}),(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white truncate",children:e.title}),e.artist&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-400 mt-1",children:[(0,s.jsx)(u.A,{className:"h-3 w-3 mr-1"}),e.artist]}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-2 pt-2 border-t border-gray-700",children:[(0,s.jsxs)(j.lG,{children:[(0,s.jsx)(j.zM,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"ghost",size:"sm",onClick:()=>C(e),children:(0,s.jsx)(d.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(j.Cf,{className:"bg-gray-900 border-gray-700 max-w-2xl",children:[(0,s.jsxs)(j.c7,{children:[(0,s.jsx)(j.L3,{className:"text-white",children:"Editar Canci\xf3n"}),(0,s.jsx)(j.rr,{className:"text-gray-400",children:"Modifica la informaci\xf3n de la canci\xf3n"})]}),f&&(0,s.jsx)(w,{song:f,onSave:e=>F(f.id,e),loading:S})]})]}),(0,s.jsxs)(j.lG,{children:[(0,s.jsx)(j.zM,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:(0,s.jsx)(g.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(j.Cf,{className:"bg-gray-900 border-gray-700",children:[(0,s.jsxs)(j.c7,{children:[(0,s.jsx)(j.L3,{className:"text-white",children:"Eliminar Canci\xf3n"}),(0,s.jsxs)(j.rr,{className:"text-gray-400",children:['\xbfEst\xe1s seguro de que quieres eliminar "',e.title,'"? Esta acci\xf3n no se puede deshacer.']})]}),(0,s.jsxs)(j.Es,{children:[(0,s.jsx)(l.$,{variant:"outline",className:"border-gray-600 text-gray-300",children:"Cancelar"}),(0,s.jsx)(l.$,{variant:"destructive",onClick:()=>J(e.id),disabled:S,children:S?"Eliminando...":"Eliminar"})]})]})]})]})]})]},e.id))}),0===z.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(h.A,{className:"h-16 w-16 text-gray-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-400 text-lg mb-2",children:c?"No se encontraron canciones":"No hay canciones"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:!c&&"Agrega tu primera canci\xf3n para comenzar"})]})]})}function w(e){var a;let{song:r,onSave:d,loading:o}=e,[h,m]=(0,t.useState)((null==r?void 0:r.title)||""),[x,g]=(0,t.useState)((null==r?void 0:r.artist)||""),[u,v]=(0,t.useState)((null==r?void 0:r.stream_url)||""),[y,N]=(0,t.useState)((null==r?void 0:r.cover_image_url)||""),[p,f]=(0,t.useState)((null==r?void 0:r.type)||"single"),[w,C]=(0,t.useState)((null==r?void 0:r.album_name)||""),[S,_]=(0,t.useState)((null==r||null==(a=r.track_number)?void 0:a.toString())||""),[E,k]=(0,t.useState)((null==r?void 0:r.release_date)||"");return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d({title:h,artist:x||null,stream_url:u,cover_image_url:y||null,type:p,album_name:"album"===p&&w||null,track_number:"album"===p&&S?parseInt(S):null,release_date:E||null})},className:"space-y-6 max-h-[70vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(n.J,{htmlFor:"title",className:"text-white",children:"T\xedtulo de la Canci\xf3n *"}),(0,s.jsx)(i.p,{id:"title",value:h,onChange:e=>m(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"Nombre de la canci\xf3n",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(n.J,{htmlFor:"artist",className:"text-white",children:"Artista"}),(0,s.jsx)(i.p,{id:"artist",value:x,onChange:e=>g(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"Nombre del artista"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(n.J,{htmlFor:"streamUrl",className:"text-white",children:"URL de Streaming *"}),(0,s.jsx)(i.p,{id:"streamUrl",value:u,onChange:e=>v(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"https://open.spotify.com/track/...",required:!0}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Enlace a Spotify, Apple Music, YouTube, etc."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(n.J,{htmlFor:"type",className:"text-white",children:"Tipo *"}),(0,s.jsxs)(c.l6,{value:p,onValueChange:e=>{f(e)},children:[(0,s.jsx)(c.bq,{className:"bg-gray-800 border-gray-600 text-white",children:(0,s.jsx)(c.yv,{placeholder:"Selecciona el tipo"})}),(0,s.jsxs)(c.gC,{className:"bg-gray-800 border-gray-600",children:[(0,s.jsx)(c.eb,{value:"single",children:"Single"}),(0,s.jsx)(c.eb,{value:"album",children:"\xc1lbum"})]})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Valor actual: ",p," (tipo: ",typeof p,")"]})]}),"album"===p&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(n.J,{htmlFor:"albumName",className:"text-white",children:"Nombre del \xc1lbum"}),(0,s.jsx)(i.p,{id:"albumName",value:w,onChange:e=>C(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"Nombre del \xe1lbum"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(n.J,{htmlFor:"trackNumber",className:"text-white",children:"N\xfamero de Track"}),(0,s.jsx)(i.p,{id:"trackNumber",type:"number",min:"1",value:S,onChange:e=>_(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"1"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(n.J,{htmlFor:"releaseDate",className:"text-white",children:"Fecha de Lanzamiento"}),(0,s.jsx)(i.p,{id:"releaseDate",type:"date",value:E,onChange:e=>k(e.target.value),className:"bg-gray-800 border-gray-600 text-white"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(n.J,{className:"text-white",children:"Imagen de Portada"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(b.A,{value:y,onChange:e=>N(e||""),label:"",maxSize:3}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:"O ingresa una URL directamente:"}),(0,s.jsx)(i.p,{value:y,onChange:e=>N(e.target.value),className:"bg-gray-800 border-gray-600 text-white",placeholder:"https://ejemplo.com/imagen.jpg"})]})]}),(0,s.jsx)(j.Es,{children:(0,s.jsx)(l.$,{type:"submit",disabled:o||!h||!u,className:"bg-white text-black hover:bg-gray-200",children:o?"Guardando...":r?"Actualizar":"Crear"})})]})}}},e=>{e.O(0,[96,76,358],()=>e(e.s=2933)),_N_E=e.O()}]);