(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{7249:(e,s,a)=>{Promise.resolve().then(a.bind(a,7513))},7513:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>E});var t=a(5155),l=a(2115),i=a(8843),r=a(7003),c=a(8525),d=a(5239),n=a(6485),o=a(1010),x=a(5880),h=a(7828),m=a(532),u=a(9347),j=a(1224),v=a(1360),p=a(3209),N=a(7812);function f(e){let{events:s,onEdit:a,onDelete:i}=e,[f,g]=(0,l.useState)(null),[b,_]=(0,l.useState)(null),y=(0,c.createClient)(),w=async e=>{g(e.id);try{let{error:s}=await y.from("events").update({is_published:!e.is_published}).eq("id",e.id);if(s)return void alert("Error al actualizar el estado");e.is_published=!e.is_published}catch(e){alert("Error al actualizar el estado")}finally{g(null)}},k=async e=>{_(e.id);try{let{error:s}=await y.from("events").update({is_featured:!e.is_featured}).eq("id",e.id);if(s)return void alert("Error al actualizar el estado destacado");e.is_featured=!e.is_featured}catch(e){alert("Error al actualizar el estado destacado")}finally{_(null)}},C=e=>new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),E=e=>e?new Date("2000-01-01T".concat(e)).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}):"",A=e=>new Date(e)>=new Date;return 0===s.length?(0,t.jsx)(p.Zp,{children:(0,t.jsxs)(p.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(n.A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"No hay eventos registrados."})]})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"hidden lg:block",children:(0,t.jsxs)(p.Zp,{children:[(0,t.jsx)(p.aR,{children:(0,t.jsxs)(p.ZB,{children:["Eventos (",s.length,")"]})}),(0,t.jsx)(p.Wu,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("th",{className:"text-left p-2",children:"Imagen"}),(0,t.jsx)("th",{className:"text-left p-2",children:"Evento"}),(0,t.jsx)("th",{className:"text-left p-2",children:"Fecha"}),(0,t.jsx)("th",{className:"text-left p-2",children:"Ubicaci\xf3n"}),(0,t.jsx)("th",{className:"text-left p-2",children:"Estado"}),(0,t.jsx)("th",{className:"text-left p-2",children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:s.map(e=>(0,t.jsxs)("tr",{className:"border-b hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)("div",{className:"w-12 h-12 relative bg-gray-200 rounded",children:e.image_url?(0,t.jsx)(d.default,{src:e.image_url,alt:e.title,fill:!0,className:"object-cover rounded"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:(0,t.jsx)(n.A,{className:"h-6 w-6"})})})}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.title}),e.venue&&(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.venue})]})}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm",children:C(e.date)}),e.time&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:E(e.time)}),A(e.date)&&(0,t.jsx)(N.E,{variant:"secondary",className:"text-xs mt-1",children:"Pr\xf3ximo"})]})}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)("p",{className:"text-sm",children:e.location||"-"})}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>w(e),disabled:f===e.id,className:e.is_published?"text-green-600":"text-red-600",children:f===e.id?(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.is_published?(0,t.jsx)(h.A,{className:"h-4 w-4"}):(0,t.jsx)(m.A,{className:"h-4 w-4"})}),(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>k(e),disabled:b===e.id,className:e.is_featured?"text-yellow-600":"text-gray-400",children:b===e.id?(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.is_featured?(0,t.jsx)(u.A,{className:"h-4 w-4 fill-current"}):(0,t.jsx)(j.A,{className:"h-4 w-4"})})]})}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.ticket_url&&(0,t.jsx)(r.$,{variant:"ghost",size:"sm",asChild:!0,children:(0,t.jsx)("a",{href:e.ticket_url,target:"_blank",rel:"noopener noreferrer",title:"Ver tickets",children:(0,t.jsx)(x.A,{className:"h-4 w-4"})})}),(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>a(e),children:(0,t.jsx)(o.A,{className:"h-4 w-4"})}),(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>i(e.id),className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(v.A,{className:"h-4 w-4"})})]})})]},e.id))})]})})})]})}),(0,t.jsx)("div",{className:"lg:hidden space-y-4",children:s.map(e=>(0,t.jsx)(p.Zp,{children:(0,t.jsx)(p.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 relative bg-gray-200 rounded flex-shrink-0",children:e.image_url?(0,t.jsx)(d.default,{src:e.image_url,alt:e.title,fill:!0,className:"object-cover rounded"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:(0,t.jsx)(n.A,{className:"h-8 w-8"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium truncate",children:e.title}),e.venue&&(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.venue})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>w(e),disabled:f===e.id,className:e.is_published?"text-green-600":"text-red-600",children:f===e.id?(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.is_published?(0,t.jsx)(h.A,{className:"h-4 w-4"}):(0,t.jsx)(m.A,{className:"h-4 w-4"})}),(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>k(e),disabled:b===e.id,className:e.is_featured?"text-yellow-600":"text-gray-400",children:b===e.id?(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.is_featured?(0,t.jsx)(u.A,{className:"h-4 w-4 fill-current"}):(0,t.jsx)(j.A,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:C(e.date)}),e.time&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:E(e.time)}),e.location&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.location})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mb-3",children:[A(e.date)&&(0,t.jsx)(N.E,{variant:"secondary",className:"text-xs",children:"Pr\xf3ximo"}),e.is_featured&&(0,t.jsx)(N.E,{className:"text-xs bg-yellow-100 text-yellow-800",children:"Destacado"}),!e.is_published&&(0,t.jsx)(N.E,{variant:"destructive",className:"text-xs",children:"No publicado"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.ticket_url&&(0,t.jsx)(r.$,{variant:"outline",size:"sm",asChild:!0,className:"flex-1",children:(0,t.jsxs)("a",{href:e.ticket_url,target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Tickets"]})}),(0,t.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>a(e),children:(0,t.jsx)(o.A,{className:"h-4 w-4"})}),(0,t.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>i(e.id),className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(v.A,{className:"h-4 w-4"})})]})]})]})})},e.id))})]})}var g=a(6363),b=a(6170),_=a(235),y=a(7001),w=a(7235),k=a(6014);function C(e){let{event:s,onClose:a}=e,[i,d]=(0,l.useState)({title:"",description:"",date:"",time:"",location:"",venue:"",ticket_url:"",image_url:"",is_featured:!1,is_published:!0}),[n,o]=(0,l.useState)(!1),x=(0,c.createClient)();(0,l.useEffect)(()=>{s&&d({title:s.title,description:s.description||"",date:s.date,time:s.time||"",location:s.location||"",venue:s.venue||"",ticket_url:s.ticket_url||"",image_url:s.image_url||"",is_featured:s.is_featured,is_published:s.is_published})},[s]);let h=async e=>{e.preventDefault(),o(!0);try{let e={title:i.title.trim(),description:i.description.trim()||null,date:i.date,time:i.time||null,location:i.location.trim()||null,venue:i.venue.trim()||null,ticket_url:i.ticket_url.trim()||null,image_url:i.image_url.trim()||null,is_featured:i.is_featured,is_published:i.is_published};if(s?(await x.from("events").update(e).eq("id",s.id)).error:(await x.from("events").insert([e])).error)return void alert("Error al guardar el evento");a()}catch(e){alert("Error al guardar el evento")}finally{o(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)(p.Zp,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(p.aR,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(p.ZB,{children:s?"Editar Evento":"Agregar Evento"}),(0,t.jsx)(r.$,{variant:"ghost",size:"sm",onClick:a,children:(0,t.jsx)(g.X,{className:"h-4 w-4"})})]}),(0,t.jsx)(p.Wu,{children:(0,t.jsxs)("form",{onSubmit:h,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.J,{htmlFor:"title",children:"T\xedtulo del Evento *"}),(0,t.jsx)(b.p,{id:"title",value:i.title,onChange:e=>d(s=>({...s,title:e.target.value})),placeholder:"Nombre del evento",required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.J,{htmlFor:"description",children:"Descripci\xf3n"}),(0,t.jsx)(y.T,{id:"description",value:i.description,onChange:e=>d(s=>({...s,description:e.target.value})),placeholder:"Descripci\xf3n del evento...",rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.J,{htmlFor:"date",children:"Fecha *"}),(0,t.jsx)(b.p,{id:"date",type:"date",value:i.date,onChange:e=>d(s=>({...s,date:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.J,{htmlFor:"time",children:"Hora"}),(0,t.jsx)(b.p,{id:"time",type:"time",value:i.time,onChange:e=>d(s=>({...s,time:e.target.value}))})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.J,{htmlFor:"venue",children:"Venue/Local"}),(0,t.jsx)(b.p,{id:"venue",value:i.venue,onChange:e=>d(s=>({...s,venue:e.target.value})),placeholder:"Nombre del lugar"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.J,{htmlFor:"location",children:"Ubicaci\xf3n"}),(0,t.jsx)(b.p,{id:"location",value:i.location,onChange:e=>d(s=>({...s,location:e.target.value})),placeholder:"Ciudad, Pa\xeds"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.J,{htmlFor:"ticket_url",children:"URL de Tickets"}),(0,t.jsx)(b.p,{id:"ticket_url",type:"url",value:i.ticket_url,onChange:e=>d(s=>({...s,ticket_url:e.target.value})),placeholder:"https://tickets.example.com/event"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Enlace donde los usuarios pueden comprar tickets"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.J,{children:"Imagen del Evento"}),(0,t.jsx)(k.o,{onImageUpload:e=>{d(s=>({...s,image_url:e}))},currentImage:i.image_url})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(w.d,{id:"is_featured",checked:i.is_featured,onCheckedChange:e=>d(s=>({...s,is_featured:e}))}),(0,t.jsx)(_.J,{htmlFor:"is_featured",children:"Evento destacado"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(w.d,{id:"is_published",checked:i.is_published,onCheckedChange:e=>d(s=>({...s,is_published:e}))}),(0,t.jsx)(_.J,{htmlFor:"is_published",children:"Publicar evento"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,t.jsx)(r.$,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),(0,t.jsx)(r.$,{type:"submit",disabled:n,children:n?"Guardando...":s?"Actualizar":"Crear"})]})]})})]})})}function E(){let[e,s]=(0,l.useState)([]),[a,d]=(0,l.useState)(!0),[n,o]=(0,l.useState)(!1),[x,h]=(0,l.useState)(null),m=(0,c.createClient)();(0,l.useEffect)(()=>{u()},[]);let u=async()=>{try{let{data:e,error:a}=await m.from("events").select("*").order("date",{ascending:!1});if(a)return;s(e||[])}catch(e){}finally{d(!1)}},j=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este evento?"))try{let{error:a}=await m.from("events").delete().eq("id",e);if(a)return void alert("Error al eliminar el evento");s(s=>s.filter(s=>s.id!==e))}catch(e){alert("Error al eliminar el evento")}};return a?(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Eventos"})}),(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{children:"Cargando eventos..."})})]}):(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Eventos"}),(0,t.jsxs)(r.$,{onClick:()=>o(!0),children:[(0,t.jsx)(i.F,{className:"h-4 w-4 mr-2"}),"Agregar Evento"]})]}),(0,t.jsx)(f,{events:e,onEdit:e=>{h(e),o(!0)},onDelete:j}),n&&(0,t.jsx)(C,{event:x,onClose:()=>{o(!1),h(null),u()}})]})}}},e=>{e.O(0,[96,76,358],()=>e(e.s=7249)),_N_E=e.O()}]);